<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>동의서 상세</title>
  <link rel="stylesheet" href="../asset/style.css">
  <link rel="stylesheet" href="../asset/modal.css">
</head>

<body class="consent-detail-page">
  <div class="container">
    <!-- 왼쪽 메뉴바 -->
    <div class="sidebar">
      <div class="logo">
        <div class="logo-icon">T</div>
        <div class="logo-text">
          <div class="logo-title">Timbel</div>
          <div class="logo-url">timbel.net</div>
        </div>
        <button class="logout-btn" title="로그아웃">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_logout)">
              <path
                d="M12 3H6.66667C5.95942 3 5.28115 3.27092 4.78105 3.75315C4.28095 4.23539 4 4.88944 4 5.57143V18.4286C4 19.1106 4.28095 19.7646 4.78105 20.2468C5.28115 20.7291 5.95942 21 6.66667 21H12"
                stroke="#4D5256" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
              <path d="M15.75 8.25L19.5 12M19.5 12L15.75 15.75M19.5 12H8" stroke="#4D5256" stroke-width="1.5"
                stroke-linecap="round" stroke-linejoin="round" />
            </g>
            <defs>
              <clipPath id="clip0_logout">
                <rect width="24" height="24" fill="white" />
              </clipPath>
            </defs>
          </svg>
        </button>
      </div>

      <div class="menu-section">
        <h3>시스템관리</h3>
        <ul>
          <li><a href="workspace.html"><img src="../asset/workspace.svg" alt="">워크스페이스 관리</a></li>
          <li><a href="system_user.html"><img src="../asset/user.svg" alt="">사용자 관리</a></li>
          <li>
            <a href="#">
              <img src="../asset/user.svg" alt="">권한 관리
              <img src="../asset/arrow-down.svg" alt="화살표" class="menu-arrow">
            </a>
            <ul class="submenu">
              <li><a href="group_setting.html">권한관리</a></li>
              <li><a href="menu_setting.html">메뉴관리</a></li>
            </ul>
          </li>
          <li><a href="system_stats.html"><img src="../asset/stats.svg" alt="">통계</a></li>
        </ul>
      </div>

      <div class="menu-section">
        <div class="menu-section-header">
          <h3>워크스페이스</h3>
        </div>
        <ul>
          <li><a href="workspace_permission.html"><img src="../asset/user.svg" alt="">권한관리</a></li>
          <li><a href="workspace_menu_setting.html"><img src="../asset/user.svg" alt="">메뉴관리</a></li>
          <li><a href="logo.html"><img src="../asset/user.svg" alt="">로고 이미지 관리</a></li>
          <li><a href="permission_settings.html"><img src="../asset/user.svg" alt="">사용메뉴 관리</a></li>
          <li><a href="auto_delete.html"><img src="../asset/history.svg" alt="">데이터 삭제관리</a></li>
          <li><a href="meet_template.html"><img src="../asset/history.svg" alt="">회의 템플릿 관리</a></li>
          <li><a href="consent.html" class="active"><img src="../asset/meeting.svg" alt="">동의서 관리</a></li>
          <li><a href="calendar.html"><img src="../asset/daily.svg" alt="">캘린더 관리</a></li>
          <li><a href="login_history.html"><img src="../asset/history.svg" alt="">이력 관리</a></li>
          <li><a href="meeting.html"><img src="../asset/meeting.svg" alt="">회의록 관리</a></li>
          <li><a href="dictionary.html"><img src="../asset/dictionary.svg" alt="">사전 관리</a></li>
          <li><a href="stats_usage.html"><img src="../asset/stats.svg" alt="">통계</a></li>
          <li><a href="user.html"><img src="../asset/user.svg" alt="">사용자 관리</a></li>
          <li><a href="prompt.html"><img src="../asset/history.svg" alt="">프롬프트 관리</a></li>
          <li><a href="download_history.html"><img src="../asset/history.svg" alt="">다운로드 이력</a></li>
          <li><a href="user_consent_history.html"><img src="../asset/history.svg" alt="">사용자 동의 이력</a></li>
          <li><a href="setting_change_history.html"><img src="../asset/history.svg" alt="">설정변경 이력</a></li>
          <li><a href="stats_user.html"><img src="../asset/stats.svg" alt="">사용자별 통계</a></li>
        </ul>
      </div>
    </div>

    <!-- 오른쪽 콘텐츠 영역 -->
    <div class="content">
      <div class="content-header">
        <div class="breadcrumb">
          <a href="consent.html" class="breadcrumb-link">동의서 관리</a> > 동의서 상세
        </div>
      </div>

      <div class="content-body">
        <!-- 동의서 상세 폼 -->
        <div class="consent-detail-form">
          <div class="form-row">
            <div class="form-group">
              <label for="consentType">구분</label>
              <div class="combo-select">
                <select id="consentType">
                  <option value="personal">개인정보</option>
                  <option value="notice">유의사항</option>
                  <option value="terms">이용약관</option>
                </select>
                <img src="../asset/select-arrow.svg" alt="화살표" class="select-arrow">
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group flex-grow">
              <label for="consentTitle">동의서명</label>
              <input type="text" id="consentTitle" class="form-input" value="개인 정보 동의서 등록" placeholder="동의서명을 입력하세요">
            </div>
          </div>

          <div class="form-row info-row">
            <div class="info-item">
              <span class="info-label">생성일</span>
              <span class="info-value">2025-07-23 16:32:54</span>
            </div>
            <div class="info-item">
              <span class="info-label">생성자</span>
              <span class="info-value">박한솔</span>
            </div>
            <div class="info-item">
              <span class="info-label">최종수정일</span>
              <span class="info-value">2025-07-25 16:58:29</span>
            </div>
            <div class="info-item">
              <span class="info-label">수정자</span>
              <span class="info-value">박한솔</span>
            </div>
            <div class="info-item">
              <span class="info-label">현재상태</span>
              <span class="status-pill draft">초안</span>
            </div>
          </div>

          <div class="form-group">
            <label for="consentContent">동의서 내용</label>
            <textarea id="consentContent" class="form-textarea" rows="15" placeholder="동의서 내용을 입력하세요">【유의사항】

A) 회의록을 통한 회의 요약 작성 시 회의 참석자의 정보나 회의 내용에 따라 정보 주체의 개인정보가 포함될 수 있습니다. 따라서 회의 요약 시 개인정보 노출을 방지할 수 있도록 주의해 주시기 바랍니다.

B) 또한, 회의록을 통한 상세한 상담내용의 정확나 회의 내용의 녹음, 편집된 회의 상담내용의 음성 인식 후의 텍스트로의 전환으로 음성, 개명, 이름, 건명, 보건, 공유, 학습, 대화하는 등 개별적이 정보를 처리 분석할 수 있습니다.

C) 개별적기 정보를 처리 위해 회의 목적에 따라 회의 목적에 맞는 작성 활용을 지향해 주시기 바랍니다.

※ 본 동의는 사업자의 서비스 운영과 기술 개발을 위한 목적이며, 동의를 거부할 권리가 있으며 동의하지 않을 경우 서비스 제공이 불가능합니다.

※ 회의 녹음은 진행한 미팅 시 미팅 대상자에게 녹음 여부를 고지하여 합니다.</textarea>
          </div>

          <div class="form-row checkbox-row">
            <div class="checkbox-group">
              <label class="checkbox-label">
                <input type="checkbox" id="activateConsent">
                <span class="checkmark"></span>
                저장 후 '사용함'으로 활성화 시 모든 기존 사용자에게 재동의를 요청합니다.
              </label>
            </div>
          </div>

          <div class="form-actions-bottom">
            <div class="left-actions">
              <a href="consent.html" class="btn btn-outline">목록으로</a>
            </div>
            <div class="right-actions">
              <button type="button" class="btn btn-outline" id="editBtn">수정</button>
              <button type="button" class="btn btn-danger" id="deleteBtn">삭제</button>
              <button type="button" class="btn btn-primary" id="saveBtn">저장</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 삭제 확인 모달 -->
  <div class="modal-overlay modal-overlay-hidden" id="deleteModal">
    <div class="modal-container">
      <div class="modal-header">
        <div class="header-content">
          <div class="header-text">
            <h2>동의서 삭제</h2>
            <p class="modal-subtitle">정말로 이 동의서를 삭제하시겠습니까?</p>
          </div>
          <button class="btn-close" id="deleteModalClose">
            <img src="../asset/close-icon.svg" alt="닫기">
          </button>
        </div>
      </div>
      <div class="modal-content">
        <div class="delete-warning">
          <p><strong>개인 정보 동의서 등록</strong>을 삭제하려고 합니다.</p>
          <p>삭제된 동의서는 복구할 수 없습니다. 정말로 삭제하시겠습니까?</p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn-cancel" id="deleteCancel">취소</button>
        <button class="btn-delete" id="deleteConfirm">삭제</button>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      let isEditMode = false;
      const editBtn = document.getElementById('editBtn');
      const saveBtn = document.getElementById('saveBtn');
      const deleteBtn = document.getElementById('deleteBtn');
      const consentTitle = document.getElementById('consentTitle');
      const consentType = document.getElementById('consentType');
      const consentContent = document.getElementById('consentContent');
      const activateConsent = document.getElementById('activateConsent');

      // 초기 상태 설정 (읽기 전용)
      function setReadOnlyMode() {
        consentTitle.readOnly = true;
        consentType.disabled = true;
        consentContent.readOnly = true;
        activateConsent.disabled = true;
        editBtn.textContent = '수정';
        saveBtn.style.display = 'none';
        isEditMode = false;
      }

      // 편집 모드 설정
      function setEditMode() {
        consentTitle.readOnly = false;
        consentType.disabled = false;
        consentContent.readOnly = false;
        activateConsent.disabled = false;
        editBtn.textContent = '취소';
        saveBtn.style.display = 'inline-block';
        isEditMode = true;
        consentTitle.focus();
      }

      // 초기 상태는 읽기 전용
      setReadOnlyMode();

      // 수정/취소 버튼 클릭
      editBtn.addEventListener('click', function () {
        if (isEditMode) {
          // 취소 - 읽기 전용으로 변경
          if (confirm('편집을 취소하시겠습니까? 변경된 내용이 저장되지 않습니다.')) {
            setReadOnlyMode();
            showNotification('편집이 취소되었습니다.', 'info');
          }
        } else {
          // 수정 - 편집 모드로 변경
          setEditMode();
          showNotification('편집 모드로 전환되었습니다.', 'info');
        }
      });

      // 저장 버튼 클릭
      saveBtn.addEventListener('click', function () {
        if (confirm('변경사항을 저장하시겠습니까?')) {
          // 실제로는 서버에 데이터 전송
          setReadOnlyMode();
          showNotification('동의서가 저장되었습니다.', 'success');

          // 활성화 체크박스가 선택되어 있으면 추가 알림
          if (activateConsent.checked) {
            setTimeout(() => {
              showNotification('모든 기존 사용자에게 재동의 요청이 전송됩니다.', 'warning');
            }, 1500);
          }
        }
      });

      // 삭제 버튼 클릭
      deleteBtn.addEventListener('click', function () {
        document.getElementById('deleteModal').classList.remove('modal-overlay-hidden');
      });

      // 삭제 모달 관련 이벤트
      const deleteModal = document.getElementById('deleteModal');
      const deleteModalClose = document.getElementById('deleteModalClose');
      const deleteCancel = document.getElementById('deleteCancel');
      const deleteConfirm = document.getElementById('deleteConfirm');

      // 모달 닫기
      deleteModalClose.addEventListener('click', function () {
        deleteModal.classList.add('modal-overlay-hidden');
      });

      deleteCancel.addEventListener('click', function () {
        deleteModal.classList.add('modal-overlay-hidden');
      });

      // 삭제 확인
      deleteConfirm.addEventListener('click', function () {
        showNotification('동의서가 삭제되었습니다.', 'success');
        deleteModal.classList.add('modal-overlay-hidden');
        // 실제로는 서버에 삭제 요청 후 목록 페이지로 이동
        setTimeout(() => {
          window.location.href = 'consent.html';
        }, 1000);
      });

      // 모달 오버레이 클릭 시 닫기
      deleteModal.addEventListener('click', function (e) {
        if (e.target === deleteModal) {
          deleteModal.classList.add('modal-overlay-hidden');
        }
      });
    });

    // 알림 메시지 표시 함수
    function showNotification(message, type = 'info') {
      const colors = {
        success: '#10B981',
        error: '#EF4444',
        warning: '#F59E0B',
        info: '#3B82F6'
      };

      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${colors[type]};
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        z-index: 10000;
        font-size: 14px;
        font-weight: 500;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        max-width: 300px;
        word-wrap: break-word;
        animation: slideIn 0.3s ease-out;
      `;
      notification.textContent = message;

      // 애니메이션 키프레임 추가
      if (!document.querySelector('#notification-styles')) {
        const style = document.createElement('style');
        style.id = 'notification-styles';
        style.textContent = `
          @keyframes slideIn {
            from {
              transform: translateX(100%);
              opacity: 0;
            }
            to {
              transform: translateX(0);
              opacity: 1;
            }
          }
        `;
        document.head.appendChild(style);
      }

      document.body.appendChild(notification);

      // 자동 제거
      setTimeout(() => {
        notification.style.animation = 'slideIn 0.3s ease-out reverse';
        setTimeout(() => {
          if (document.body.contains(notification)) {
            document.body.removeChild(notification);
          }
        }, 300);
      }, 3000);

      // 클릭으로 제거
      notification.addEventListener('click', () => {
        if (document.body.contains(notification)) {
          document.body.removeChild(notification);
        }
      });
    }
  </script>
  <script src="../asset/menu.js"></script>
  <script src="../asset/main.js"></script>
</body>

</html>