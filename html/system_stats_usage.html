<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>전체 시스템 관리 - 사용량 통계</title>
  <link rel="stylesheet" href="../asset/style.css">
  <!-- 내부 스타일을 style.css로 이동했습니다 -->
</head>

<body class="stats-usage-page">
  <div class="container stats-usage-page">
    <div class="sidebar">
      <div class="logo">
        <div class="logo-icon">T</div>
        <div class="logo-text">
          <div class="logo-title">홍길동</div>
          <div class="logo-url">
            <select class="condition-select" id="workspace-filter">
              <option value="Timbel" selected>Timbel</option>
              <option value="sk-telecom">SK Telecom</option>
              <option value="sk-hynix">SK Hynix</option>
              <option value="sk-es">SK E&S</option>
              <option value="sk-cc">SK C&C</option>
              <option value="sk-innovation">SK Innovation</option>
              <option value="sk-networks">SK Networks</option>
            </select>
          </div>
        </div>
        <button class="logout-btn" title="로그아웃">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_logout)">
              <path
                d="M12 3H6.66667C5.95942 3 5.28115 3.27092 4.78105 3.75315C4.28095 4.23539 4 4.88944 4 5.57143V18.4286C4 19.1106 4.28095 19.7646 4.78105 20.2468C5.28115 20.7291 5.95942 21 6.66667 21H12"
                stroke="#4D5256" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
              <path d="M15.75 8.25L19.5 12M19.5 12L15.75 15.75M19.5 12H8" stroke="#4D5256" stroke-width="1.5"
                stroke-linecap="round" stroke-linejoin="round" />
            </g>
            <defs>
              <clipPath id="clip0_logout">
                <rect width="24" height="24" fill="white" />
              </clipPath>
            </defs>
          </svg>
        </button>
      </div>

      <div class="menu-section">
        <h3>전체 시스템 관리</h3>
        <ul>
          <li><a href="workspace.html">워크스페이스 관리</a></li>
          <li><a href="menu_setting.html">전체 메뉴 관리</a></li>
          <li><a href="system_user.html">사용자 관리</a></li>
          <li><a href="group_setting.html">역할 관리</a></li>
          <li><a href="system_setting_history.html">설정변경 이력</a></li>
          <li><a href="system_stats_usage.html" class="active">전체 시스템 사용 통계</a></li>
          <li><a href="system_stats_user.html">사용자별 사용 통계</a></li>
        </ul>
      </div>

      <div class="menu-section">
        <div class="menu-section-header">
          <h3>워크스페이스 설정</h3>
        </div>
        <ul>
          <li><a href="workspace_permission.html">기능 권한 관리</a></li>
          <li><a href="content_retention.html">컨텐츠 보존 관리</a></li>
          <li><a href="workspace_group_setting.html">역할 관리</a></li>
          <li><a href="user.html">사용자 관리</a></li>
          <li><a href="logo.html">로고 관리</a></li>
        </ul>
      </div>

      <div class="menu-section">
        <div class="menu-section-header">
          <h3>세부 기능 관리</h3>
        </div>
        <ul>
          <li><a href="meet_template.html">템플릿 관리 (회의록, 공통 템플릿)</a></li>
          <li><a href="prompt.html">프롬프트 관리</a></li>
          <li><a href="consent.html">동의서 관리</a></li>
          <li><a href="calendar.html">캘린더 관리/설정</a></li>
          <li><a href="dictionary.html">사전 관리</a></li>
          <li><a href="notice.html">공지사항 관리</a></li>
        </ul>
      </div>

      <div class="menu-section">
        <div class="menu-section-header">
          <h3>이력/통계 관리</h3>
        </div>
        <ul>
          <li><a href="login_history.html">사용자 접속 이력</a></li>
          <li><a href="download_history.html">다운로드 이력</a></li>
          <li><a href="user_consent_history.html">사용자 동의 이력</a></li>
          <li><a href="setting_change_history.html">설정 변경 이력</a></li>
          <li><a href="meeting.html">회의록 이력</a></li>
          <li><a href="stats_usage.html">워크스페이스 사용 통계</a></li>
          <li><a href="stats_user.html">사용자별 사용 통계</a></li>
        </ul>
      </div>
    </div>
    <div class="content">
      <div class="content-header">
        <h1 class="breadcrumb">전체 시스템 사용 통계</h1>
      </div>
      <div class="content-body">
        <div class="search-section">
          <div class="">
            <div class="tb-left">

              <div class="workspace-filter-row"
                style="margin-bottom: 15px; display: flex; align-items: center; gap: 15px;">
                <div style="display: flex; align-items: center; gap: 8px;">
                  <select class="condition-select" id="workspace-filter">
                    <option value="all" selected>전체 워크스페이스</option>
                    <option value="sk-telecom">SK Telecom</option>
                    <option value="sk-hynix">SK Hynix</option>
                    <option value="sk-es">SK E&S</option>
                    <option value="sk-cc">SK C&C</option>
                    <option value="sk-innovation">SK Innovation</option>
                    <option value="sk-networks">SK Networks</option>
                  </select>
                </div>
                <div class="stats-tabs period-toggle-wrap">
                  <button class="tab active period-toggle-active">월간</button>
                  <button class="tab period-toggle-inactive">연간</button>
                </div>
              </div>
              <div class="period-row period-row-flex">
                <select class="condition-select" id="su2-y1">
                  <option selected>2024년</option>
                  <option>2025년</option>
                </select>
                <select class="condition-select" id="su2-m1">
                  <option>1월</option>
                  <option>2월</option>
                  <option>3월</option>
                  <option>4월</option>
                  <option>5월</option>
                  <option>6월</option>
                  <option>7월</option>
                  <option selected>8월</option>
                  <option>9월</option>
                  <option>10월</option>
                  <option>11월</option>
                  <option>12월</option>
                </select>
                <span class="period-separator">~</span>
                <select class="condition-select" id="su2-y2">
                  <option>2024년</option>
                  <option selected>2025년</option>
                </select>
                <select class="condition-select" id="su2-m2">
                  <option>1월</option>
                  <option>2월</option>
                  <option>3월</option>
                  <option>4월</option>
                  <option>5월</option>
                  <option>6월</option>
                  <option>7월</option>
                  <option selected>8월</option>
                  <option>9월</option>
                  <option>10월</option>
                  <option>11월</option>
                  <option>12월</option>
                </select>
                <button class="btn-query" id="su2-run">조회</button>
                <div class="tb-right">
                  <button class="btn"
                    style="background-color: transparent; color: #10B981; border: 1px solid #10B981; margin-right: 8px; transition: all 0.2s ease;">
                    엑셀 다운로드
                  </button>

                </div>
              </div>
            </div>

          </div>
          <div id="su2-result-text" class="result-text">2024년 08월 ~ 2025년 08월 워크스페이스별 월간 통계 결과</div>
        </div>

        <!-- 월간 테이블 -->
        <div class="table-container" id="monthly-table">
          <table>
            <thead>
              <tr>
                <th>워크스페이스</th>
                <th>월</th>
                <th>STT 요청 건수</th>
                <th>STT 요청 시간</th>
                <th>STT 성공 건수</th>
                <th>STT 성공 시간</th>
                <th>STT 실패 건수</th>
                <th>STT 실패 시간</th>
                <th>LLM 요청 건수</th>
                <th>LLM 요청 Token</th>
                <th>LLM 성공 건수</th>
                <th>LLM 실패 건수</th>
              </tr>
            </thead>
            <tbody>
              <!-- SK Telecom -->
              <tr>
                <td rowspan="6">
                  <div class="workspace-name">
                    <div class="workspace-icon color-teal">S</div>
                    <span>SK Telecom</span>
                  </div>
                </td>
                <td><strong>2025.01</strong></td>
                <td>38건</td>
                <td>16:22:18</td>
                <td>36건</td>
                <td>15:45:43</td>
                <td>2건</td>
                <td>0:36:35</td>
                <td>32건</td>
                <td>52,840</td>
                <td>30건</td>
                <td>2건</td>
              </tr>
              <tr>
                <td><strong>2024.12</strong></td>
                <td>72건</td>
                <td>28:45:23</td>
                <td>68건</td>
                <td>27:30:18</td>
                <td>4건</td>
                <td>1:15:05</td>
                <td>62건</td>
                <td>98,750</td>
                <td>58건</td>
                <td>4건</td>
              </tr>
              <tr>
                <td><strong>2024.11</strong></td>
                <td>56건</td>
                <td>22:18:50</td>
                <td>53건</td>
                <td>21:25:35</td>
                <td>3건</td>
                <td>0:53:15</td>
                <td>48건</td>
                <td>78,920</td>
                <td>45건</td>
                <td>3건</td>
              </tr>
              <tr>
                <td><strong>2024.10</strong></td>
                <td>28건</td>
                <td>15:45:12</td>
                <td>26건</td>
                <td>14:58:47</td>
                <td>2건</td>
                <td>0:46:25</td>
                <td>24건</td>
                <td>41,670</td>
                <td>22건</td>
                <td>2건</td>
              </tr>
              <tr>
                <td><strong>2024.09</strong></td>
                <td>45건</td>
                <td>18:22:33</td>
                <td>42건</td>
                <td>17:30:18</td>
                <td>3건</td>
                <td>0:52:15</td>
                <td>38건</td>
                <td>62,480</td>
                <td>35건</td>
                <td>3건</td>
              </tr>
              <tr>
                <td><strong>2024.08</strong></td>
                <td>32건</td>
                <td>12:30:45</td>
                <td>30건</td>
                <td>11:45:20</td>
                <td>2건</td>
                <td>0:45:25</td>
                <td>28건</td>
                <td>45,230</td>
                <td>26건</td>
                <td>2건</td>
              </tr>
              <tr style="background-color: #f8f9fa; font-weight: bold; border-top: 2px solid #dee2e6;">
                <td colspan="2" style="text-align: center; color: #6c757d;">소계</td>
                <td>271건</td>
                <td>123:34:41</td>
                <td>255건</td>
                <td>117:25:17</td>
                <td>16건</td>
                <td>6:09:24</td>
                <td>240건</td>
                <td>383,590</td>
                <td>225건</td>
                <td>15건</td>
              </tr>

              <!-- SK Hynix -->
              <tr>
                <td rowspan="6">
                  <div class="workspace-name">
                    <div class="workspace-icon color-indigo">S</div>
                    <span>SK Hynix</span>
                  </div>
                </td>
                <td><strong>2025.01</strong></td>
                <td>29건</td>
                <td>13:45:20</td>
                <td>28건</td>
                <td>13:20:05</td>
                <td>1건</td>
                <td>0:25:15</td>
                <td>26건</td>
                <td>42,380</td>
                <td>25건</td>
                <td>1건</td>
              </tr>
              <tr>
                <td><strong>2024.12</strong></td>
                <td>54건</td>
                <td>22:18:45</td>
                <td>51건</td>
                <td>21:30:22</td>
                <td>3건</td>
                <td>0:48:23</td>
                <td>48건</td>
                <td>78,640</td>
                <td>45건</td>
                <td>3건</td>
              </tr>
              <tr>
                <td><strong>2024.11</strong></td>
                <td>38건</td>
                <td>16:22:33</td>
                <td>36건</td>
                <td>15:50:18</td>
                <td>2건</td>
                <td>0:32:15</td>
                <td>34건</td>
                <td>55,920</td>
                <td>32건</td>
                <td>2건</td>
              </tr>
              <tr>
                <td><strong>2024.10</strong></td>
                <td>42건</td>
                <td>18:30:45</td>
                <td>40건</td>
                <td>17:45:30</td>
                <td>2건</td>
                <td>0:45:15</td>
                <td>38건</td>
                <td>62,180</td>
                <td>36건</td>
                <td>2건</td>
              </tr>
              <tr>
                <td><strong>2024.09</strong></td>
                <td>25건</td>
                <td>12:45:22</td>
                <td>24건</td>
                <td>12:15:10</td>
                <td>1건</td>
                <td>0:30:12</td>
                <td>22건</td>
                <td>38,750</td>
                <td>21건</td>
                <td>1건</td>
              </tr>
              <tr>
                <td><strong>2024.08</strong></td>
                <td>18건</td>
                <td>8:15:30</td>
                <td>17건</td>
                <td>7:45:15</td>
                <td>1건</td>
                <td>0:30:15</td>
                <td>16건</td>
                <td>28,450</td>
                <td>15건</td>
                <td>1건</td>
              </tr>
              <tr style="background-color: #f8f9fa; font-weight: bold; border-top: 2px solid #dee2e6;">
                <td colspan="2" style="text-align: center; color: #6c757d;">소계</td>
                <td>206건</td>
                <td>88:07:25</td>
                <td>196건</td>
                <td>84:33:00</td>
                <td>10건</td>
                <td>3:34:25</td>
                <td>184건</td>
                <td>286,320</td>
                <td>174건</td>
                <td>10건</td>
              </tr>

              <!-- SK E&S -->
              <tr>
                <td rowspan="6">
                  <div class="workspace-name">
                    <div class="workspace-icon color-rose">S</div>
                    <span>SK E&S</span>
                  </div>
                </td>
                <td><strong>2025.01</strong></td>
                <td>32건</td>
                <td>14:52:38</td>
                <td>31건</td>
                <td>14:28:15</td>
                <td>1건</td>
                <td>0:24:23</td>
                <td>29건</td>
                <td>48,620</td>
                <td>28건</td>
                <td>1건</td>
              </tr>
              <tr>
                <td><strong>2024.12</strong></td>
                <td>58건</td>
                <td>24:38:52</td>
                <td>55건</td>
                <td>23:42:30</td>
                <td>3건</td>
                <td>0:56:22</td>
                <td>52건</td>
                <td>85,940</td>
                <td>49건</td>
                <td>3건</td>
              </tr>
              <tr>
                <td><strong>2024.11</strong></td>
                <td>41건</td>
                <td>18:12:25</td>
                <td>39건</td>
                <td>17:35:18</td>
                <td>2건</td>
                <td>0:37:07</td>
                <td>37건</td>
                <td>61,720</td>
                <td>35건</td>
                <td>2건</td>
              </tr>
              <tr>
                <td><strong>2024.10</strong></td>
                <td>48건</td>
                <td>20:45:18</td>
                <td>46건</td>
                <td>19:58:42</td>
                <td>2건</td>
                <td>0:46:36</td>
                <td>44건</td>
                <td>72,560</td>
                <td>42건</td>
                <td>2건</td>
              </tr>
              <tr>
                <td><strong>2024.09</strong></td>
                <td>34건</td>
                <td>15:28:33</td>
                <td>32건</td>
                <td>14:50:22</td>
                <td>2건</td>
                <td>0:38:11</td>
                <td>30건</td>
                <td>51,360</td>
                <td>28건</td>
                <td>2건</td>
              </tr>
              <tr>
                <td><strong>2024.08</strong></td>
                <td>22건</td>
                <td>10:35:45</td>
                <td>21건</td>
                <td>10:15:30</td>
                <td>1건</td>
                <td>0:20:15</td>
                <td>19건</td>
                <td>32,480</td>
                <td>18건</td>
                <td>1건</td>
              </tr>
              <tr style="background-color: #f8f9fa; font-weight: bold; border-top: 2px solid #dee2e6;">
                <td colspan="2" style="text-align: center; color: #6c757d;">소계</td>
                <td>235건</td>
                <td>104:33:31</td>
                <td>224건</td>
                <td>100:50:37</td>
                <td>11건</td>
                <td>3:42:54</td>
                <td>211건</td>
                <td>352,680</td>
                <td>200건</td>
                <td>11건</td>
              </tr>

              <!-- SK C&C -->
              <tr>
                <td rowspan="6">
                  <div class="workspace-name">
                    <div class="workspace-icon color-amber">S</div>
                    <span>SK C&C</span>
                  </div>
                </td>
                <td><strong>2025.01</strong></td>
                <td>25건</td>
                <td>11:38:28</td>
                <td>24건</td>
                <td>11:15:30</td>
                <td>1건</td>
                <td>0:22:58</td>
                <td>22건</td>
                <td>38,740</td>
                <td>21건</td>
                <td>1건</td>
              </tr>
              <tr>
                <td><strong>2024.12</strong></td>
                <td>46건</td>
                <td>20:18:55</td>
                <td>44건</td>
                <td>19:35:48</td>
                <td>2건</td>
                <td>0:43:07</td>
                <td>41건</td>
                <td>69,480</td>
                <td>39건</td>
                <td>2건</td>
              </tr>
              <tr>
                <td><strong>2024.11</strong></td>
                <td>32건</td>
                <td>14:52:26</td>
                <td>30건</td>
                <td>14:22:15</td>
                <td>2건</td>
                <td>0:30:11</td>
                <td>28건</td>
                <td>48,350</td>
                <td>26건</td>
                <td>2건</td>
              </tr>
              <tr>
                <td><strong>2024.10</strong></td>
                <td>36건</td>
                <td>16:28:42</td>
                <td>34건</td>
                <td>15:52:18</td>
                <td>2건</td>
                <td>0:36:24</td>
                <td>32건</td>
                <td>54,620</td>
                <td>30건</td>
                <td>2건</td>
              </tr>
              <tr>
                <td><strong>2024.09</strong></td>
                <td>28건</td>
                <td>13:45:38</td>
                <td>27건</td>
                <td>13:18:22</td>
                <td>1건</td>
                <td>0:27:16</td>
                <td>25건</td>
                <td>42,790</td>
                <td>24건</td>
                <td>1건</td>
              </tr>
              <tr>
                <td><strong>2024.08</strong></td>
                <td>15건</td>
                <td>7:22:15</td>
                <td>14건</td>
                <td>6:58:30</td>
                <td>1건</td>
                <td>0:23:45</td>
                <td>13건</td>
                <td>23,180</td>
                <td>12건</td>
                <td>1건</td>
              </tr>
              <tr style="background-color: #f8f9fa; font-weight: bold; border-top: 2px solid #dee2e6;">
                <td colspan="2" style="text-align: center; color: #6c757d;">소계</td>
                <td>182건</td>
                <td>84:26:24</td>
                <td>173건</td>
                <td>81:22:43</td>
                <td>9건</td>
                <td>3:03:41</td>
                <td>161건</td>
                <td>277,160</td>
                <td>152건</td>
                <td>9건</td>
              </tr>

              <!-- SK Innovation -->
              <tr>
                <td rowspan="6">
                  <div class="workspace-name">
                    <div class="workspace-icon color-emerald">S</div>
                    <span>SK Innovation</span>
                  </div>
                </td>
                <td><strong>2025.01</strong></td>
                <td>35건</td>
                <td>16:18:42</td>
                <td>34건</td>
                <td>15:48:25</td>
                <td>1건</td>
                <td>0:30:17</td>
                <td>32건</td>
                <td>54,620</td>
                <td>31건</td>
                <td>1건</td>
              </tr>
              <tr>
                <td><strong>2024.12</strong></td>
                <td>62건</td>
                <td>26:48:35</td>
                <td>59건</td>
                <td>25:52:18</td>
                <td>3건</td>
                <td>0:56:17</td>
                <td>56건</td>
                <td>92,470</td>
                <td>53건</td>
                <td>3건</td>
              </tr>
              <tr>
                <td><strong>2024.11</strong></td>
                <td>44건</td>
                <td>19:28:52</td>
                <td>42건</td>
                <td>18:52:38</td>
                <td>2건</td>
                <td>0:36:14</td>
                <td>40건</td>
                <td>67,280</td>
                <td>38건</td>
                <td>2건</td>
              </tr>
              <tr>
                <td><strong>2024.10</strong></td>
                <td>52건</td>
                <td>22:35:47</td>
                <td>49건</td>
                <td>21:45:28</td>
                <td>3건</td>
                <td>0:50:19</td>
                <td>46건</td>
                <td>76,840</td>
                <td>43건</td>
                <td>3건</td>
              </tr>
              <tr>
                <td><strong>2024.09</strong></td>
                <td>39건</td>
                <td>17:42:28</td>
                <td>37건</td>
                <td>17:08:35</td>
                <td>2건</td>
                <td>0:33:53</td>
                <td>35건</td>
                <td>58,920</td>
                <td>33건</td>
                <td>2건</td>
              </tr>
              <tr>
                <td><strong>2024.08</strong></td>
                <td>26건</td>
                <td>12:15:33</td>
                <td>25건</td>
                <td>11:48:22</td>
                <td>1건</td>
                <td>0:27:11</td>
                <td>23건</td>
                <td>39,560</td>
                <td>22건</td>
                <td>1건</td>
              </tr>
              <tr style="background-color: #f8f9fa; font-weight: bold; border-top: 2px solid #dee2e6;">
                <td colspan="2" style="text-align: center; color: #6c757d;">소계</td>
                <td>258건</td>
                <td>115:10:17</td>
                <td>246건</td>
                <td>111:15:46</td>
                <td>12건</td>
                <td>3:54:31</td>
                <td>232건</td>
                <td>389,690</td>
                <td>220건</td>
                <td>12건</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- 연간 테이블 -->
        <div class="table-container" id="yearly-table" style="display: none;">
          <table>
            <thead>
              <tr>
                <th>워크스페이스</th>
                <th>연도</th>
                <th>STT 요청 건수</th>
                <th>STT 요청 시간</th>
                <th>STT 성공 건수</th>
                <th>STT 성공 시간</th>
                <th>STT 실패 건수</th>
                <th>STT 실패 시간</th>
                <th>LLM 요청 건수</th>
                <th>LLM 요청 Token</th>
                <th>LLM 성공 건수</th>
                <th>LLM 실패 건수</th>
              </tr>
            </thead>
            <tbody>
              <!-- SK Telecom -->
              <tr>
                <td rowspan="5">
                  <div class="workspace-name">
                    <div class="workspace-icon color-teal">S</div>
                    <span>SK Telecom</span>
                  </div>
                </td>
                <td><strong>2025년</strong></td>
                <td>994건</td>
                <td>624:30:18</td>
                <td>948건</td>
                <td>594:15:45</td>
                <td>46건</td>
                <td>30:14:33</td>
                <td>902건</td>
                <td>1,478,620</td>
                <td>860건</td>
                <td>42건</td>
              </tr>
              <tr>
                <td><strong>2024년</strong></td>
                <td>824건</td>
                <td>512:18:22</td>
                <td>785건</td>
                <td>487:30:18</td>
                <td>39건</td>
                <td>24:48:04</td>
                <td>748건</td>
                <td>1,224,970</td>
                <td>712건</td>
                <td>36건</td>
              </tr>
              <tr>
                <td><strong>2023년</strong></td>
                <td>758건</td>
                <td>452:30:45</td>
                <td>720건</td>
                <td>430:15:30</td>
                <td>38건</td>
                <td>22:15:15</td>
                <td>685건</td>
                <td>1,124,680</td>
                <td>652건</td>
                <td>33건</td>
              </tr>
              <tr>
                <td><strong>2022년</strong></td>
                <td>642건</td>
                <td>386:22:18</td>
                <td>612건</td>
                <td>368:45:12</td>
                <td>30건</td>
                <td>17:37:06</td>
                <td>580건</td>
                <td>948,750</td>
                <td>548건</td>
                <td>32건</td>
              </tr>
              <tr>
                <td><strong>2021년</strong></td>
                <td>486건</td>
                <td>298:45:30</td>
                <td>462건</td>
                <td>285:20:15</td>
                <td>24건</td>
                <td>13:25:15</td>
                <td>420건</td>
                <td>685,470</td>
                <td>395건</td>
                <td>25건</td>
              </tr>
              <tr style="background-color: #f8f9fa; font-weight: bold; border-top: 2px solid #dee2e6;">
                <td colspan="2" style="text-align: center; color: #6c757d;">소계</td>
                <td>3,456건</td>
                <td>2,081:56:22</td>
                <td>3,280건</td>
                <td>1,999:56:22</td>
                <td>196건</td>
                <td>82:00:00</td>
                <td>3,084건</td>
                <td>4,964,000</td>
                <td>3,040건</td>
                <td>196건</td>
              </tr>

              <!-- SK E&S -->
              <tr>
                <td rowspan="6">
                  <div class="workspace-name">
                    <div class="workspace-icon color-rose">S</div>
                    <span>SK E&S</span>
                  </div>
                </td>
                <td><strong>2024년</strong></td>
                <td>156건</td>
                <td>68:45:30</td>
                <td>148건</td>
                <td>65:20:15</td>
                <td>8건</td>
                <td>3:25:15</td>
                <td>142건</td>
                <td>234,680</td>
                <td>135건</td>
                <td>7건</td>
              </tr>
              <tr>
                <td><strong>2023년</strong></td>
                <td>89건</td>
                <td>42:15:45</td>
                <td>85건</td>
                <td>40:30:20</td>
                <td>4건</td>
                <td>1:45:25</td>
                <td>78건</td>
                <td>128,950</td>
                <td>74건</td>
                <td>4건</td>
              </tr>
              <tr>
                <td><strong>2022년</strong></td>
                <td>67건</td>
                <td>31:22:18</td>
                <td>64건</td>
                <td>29:45:30</td>
                <td>3건</td>
                <td>1:36:48</td>
                <td>58건</td>
                <td>95,420</td>
                <td>55건</td>
                <td>3건</td>
              </tr>
              <tr>
                <td><strong>2021년</strong></td>
                <td>45건</td>
                <td>22:18:33</td>
                <td>43건</td>
                <td>21:15:20</td>
                <td>2건</td>
                <td>1:03:13</td>
                <td>39건</td>
                <td>64,280</td>
                <td>37건</td>
                <td>2건</td>
              </tr>
              <tr>
                <td><strong>2020년</strong></td>
                <td>32건</td>
                <td>15:45:22</td>
                <td>30건</td>
                <td>14:30:15</td>
                <td>2건</td>
                <td>1:15:07</td>
                <td>28건</td>
                <td>46,150</td>
                <td>26건</td>
                <td>2건</td>
              </tr>
              <tr>
                <td><strong>2019년</strong></td>
                <td>28건</td>
                <td>13:22:45</td>
                <td>26건</td>
                <td>12:45:30</td>
                <td>2건</td>
                <td>0:37:15</td>
                <td>24건</td>
                <td>39,680</td>
                <td>22건</td>
                <td>2건</td>
              </tr>
              <tr style="background-color: #f8f9fa; font-weight: bold; border-top: 2px solid #dee2e6;">
                <td colspan="2" style="text-align: center; color: #6c757d;">소계</td>
                <td>417건</td>
                <td>193:50:13</td>
                <td>396건</td>
                <td>184:07:30</td>
                <td>21건</td>
                <td>9:42:43</td>
                <td>369건</td>
                <td>609,160</td>
                <td>349건</td>
                <td>20건</td>
              </tr>

              <!-- SK C&C -->
              <tr>
                <td rowspan="6">
                  <div class="workspace-name">
                    <div class="workspace-icon color-amber">S</div>
                    <span>SK C&C</span>
                  </div>
                </td>
                <td><strong>2024년</strong></td>
                <td>198건</td>
                <td>85:30:45</td>
                <td>189건</td>
                <td>81:15:30</td>
                <td>9건</td>
                <td>4:15:15</td>
                <td>175건</td>
                <td>289,450</td>
                <td>168건</td>
                <td>7건</td>
              </tr>
              <tr>
                <td><strong>2023년</strong></td>
                <td>134건</td>
                <td>58:22:18</td>
                <td>128건</td>
                <td>55:45:20</td>
                <td>6건</td>
                <td>2:36:58</td>
                <td>118건</td>
                <td>194,680</td>
                <td>112건</td>
                <td>6건</td>
              </tr>
              <tr>
                <td><strong>2022년</strong></td>
                <td>98건</td>
                <td>42:15:33</td>
                <td>94건</td>
                <td>40:30:15</td>
                <td>4건</td>
                <td>1:45:18</td>
                <td>86건</td>
                <td>142,150</td>
                <td>82건</td>
                <td>4건</td>
              </tr>
              <tr>
                <td><strong>2021년</strong></td>
                <td>76건</td>
                <td>33:45:22</td>
                <td>73건</td>
                <td>32:15:10</td>
                <td>3건</td>
                <td>1:30:12</td>
                <td>67건</td>
                <td>110,680</td>
                <td>64건</td>
                <td>3건</td>
              </tr>
              <tr>
                <td><strong>2020년</strong></td>
                <td>54건</td>
                <td>24:18:45</td>
                <td>52건</td>
                <td>23:30:20</td>
                <td>2건</td>
                <td>0:48:25</td>
                <td>48건</td>
                <td>79,250</td>
                <td>46건</td>
                <td>2건</td>
              </tr>
              <tr>
                <td><strong>2019년</strong></td>
                <td>42건</td>
                <td>18:45:30</td>
                <td>40건</td>
                <td>17:30:15</td>
                <td>2건</td>
                <td>1:15:15</td>
                <td>36건</td>
                <td>59,420</td>
                <td>34건</td>
                <td>2건</td>
              </tr>
              <tr style="background-color: #f8f9fa; font-weight: bold; border-top: 2px solid #dee2e6;">
                <td colspan="2" style="text-align: center; color: #6c757d;">소계</td>
                <td>602건</td>
                <td>262:58:13</td>
                <td>576건</td>
                <td>250:46:30</td>
                <td>26건</td>
                <td>12:11:43</td>
                <td>532건</td>
                <td>875,630</td>
                <td>506건</td>
                <td>24건</td>
              </tr>

              <!-- SK Innovation -->
              <tr>
                <td rowspan="6">
                  <div class="workspace-name">
                    <div class="workspace-icon color-emerald">S</div>
                    <span>SK Innovation</span>
                  </div>
                </td>
                <td><strong>2024년</strong></td>
                <td>112건</td>
                <td>48:22:15</td>
                <td>108건</td>
                <td>46:15:30</td>
                <td>4건</td>
                <td>2:06:45</td>
                <td>98건</td>
                <td>161,680</td>
                <td>94건</td>
                <td>4건</td>
              </tr>
              <tr>
                <td><strong>2023년</strong></td>
                <td>89건</td>
                <td>38:45:22</td>
                <td>86건</td>
                <td>37:15:10</td>
                <td>3건</td>
                <td>1:30:12</td>
                <td>78건</td>
                <td>128,750</td>
                <td>75건</td>
                <td>3건</td>
              </tr>
              <tr>
                <td><strong>2022년</strong></td>
                <td>67건</td>
                <td>29:18:45</td>
                <td>64건</td>
                <td>28:15:20</td>
                <td>3건</td>
                <td>1:03:25</td>
                <td>58건</td>
                <td>95,680</td>
                <td>55건</td>
                <td>3건</td>
              </tr>
              <tr>
                <td><strong>2021년</strong></td>
                <td>54건</td>
                <td>23:45:30</td>
                <td>52건</td>
                <td>22:30:15</td>
                <td>2건</td>
                <td>1:15:15</td>
                <td>48건</td>
                <td>79,250</td>
                <td>46건</td>
                <td>2건</td>
              </tr>
              <tr>
                <td><strong>2020년</strong></td>
                <td>43건</td>
                <td>18:30:22</td>
                <td>41건</td>
                <td>17:45:10</td>
                <td>2건</td>
                <td>0:45:12</td>
                <td>38건</td>
                <td>62,680</td>
                <td>36건</td>
                <td>2건</td>
              </tr>
              <tr>
                <td><strong>2019년</strong></td>
                <td>38건</td>
                <td>16:22:45</td>
                <td>36건</td>
                <td>15:30:20</td>
                <td>2건</td>
                <td>0:52:25</td>
                <td>32건</td>
                <td>52,850</td>
                <td>30건</td>
                <td>2건</td>
              </tr>
              <tr style="background-color: #f8f9fa; font-weight: bold; border-top: 2px solid #dee2e6;">
                <td colspan="2" style="text-align: center; color: #6c757d;">소계</td>
                <td>403건</td>
                <td>175:04:59</td>
                <td>387건</td>
                <td>168:31:05</td>
                <td>16건</td>
                <td>6:33:54</td>
                <td>352건</td>
                <td>580,890</td>
                <td>336건</td>
                <td>16건</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- 무한 스크롤을 위한 로딩 인디케이터 -->
        <div class="infinite-scroll-loading" id="loadingIndicator"
          style="display: none; text-align: center; padding: 20px;">
          <div class="loading-spinner"
            style="display: inline-block; width: 20px; height: 20px; border: 2px solid #f3f3f3; border-top: 2px solid #3498db; border-radius: 50%; animation: spin 1s linear infinite;">
          </div>
          <span style="margin-left: 10px; color: #666;">더 많은 데이터를 불러오는 중...</span>
        </div>

        <style>
          @keyframes spin {
            0% {
              transform: rotate(0deg);
            }

            100% {
              transform: rotate(360deg);
            }
          }
        </style>
      </div>
    </div>
  </div>

  <script>
    // 탭 전환 및 엑셀 다운로드 기능
    document.addEventListener('DOMContentLoaded', function () {
      // 탭 버튼들
      const monthlyTab = document.querySelector('.workspace-filter-row .tab.active');
      const yearlyTab = document.querySelector('.workspace-filter-row .tab.period-toggle-inactive');
      const monthlyTable = document.getElementById('monthly-table');
      const yearlyTable = document.getElementById('yearly-table');
      const monthSelect = document.getElementById('su2-m1');
      const monthSelect2 = document.getElementById('su2-m2');
      const resultText = document.getElementById('su2-result-text');

      // 월간 탭 클릭
      monthlyTab.addEventListener('click', function () {
        // 탭 활성화 상태 변경
        monthlyTab.classList.add('active', 'period-toggle-active');
        monthlyTab.classList.remove('period-toggle-inactive');
        yearlyTab.classList.remove('active', 'period-toggle-active');
        yearlyTab.classList.add('period-toggle-inactive');

        // 테이블 전환
        monthlyTable.style.display = 'block';
        yearlyTable.style.display = 'none';

        // 월 선택 필드 표시
        monthSelect.style.display = 'inline-block';
        monthSelect2.style.display = 'inline-block';

        // 결과 텍스트 업데이트
        resultText.textContent = '2024년 08월 ~ 2025년 08월 워크스페이스별 월간 통계 결과';
      });

      // 연간 탭 클릭
      yearlyTab.addEventListener('click', function () {
        // 탭 활성화 상태 변경
        yearlyTab.classList.add('active', 'period-toggle-active');
        yearlyTab.classList.remove('period-toggle-inactive');
        monthlyTab.classList.remove('active', 'period-toggle-active');
        monthlyTab.classList.add('period-toggle-inactive');

        // 테이블 전환
        monthlyTable.style.display = 'none';
        yearlyTable.style.display = 'block';

        // 월 선택 필드 숨기기
        monthSelect.style.display = 'none';
        monthSelect2.style.display = 'none';

        // 결과 텍스트 업데이트
        resultText.textContent = '2021년 ~ 2025년 워크스페이스별 연간 통계 결과';
      });

      // 워크스페이스 필터 기능
      const workspaceFilter = document.getElementById('workspace-filter');
      workspaceFilter.addEventListener('change', function () {
        const selectedValue = this.value;
        const rows = document.querySelectorAll('#monthly-table tbody tr, #yearly-table tbody tr');

        rows.forEach(row => {
          if (selectedValue === 'all') {
            row.style.display = '';
          } else {
            const workspaceName = row.querySelector('.workspace-name span');
            if (workspaceName) {
              const name = workspaceName.textContent.toLowerCase();
              const shouldShow = (
                (selectedValue === 'sk-telecom' && name.includes('sk telecom')) ||
                (selectedValue === 'sk-hynix' && name.includes('sk hynix')) ||
                (selectedValue === 'sk-es' && name.includes('sk e&s')) ||
                (selectedValue === 'sk-cc' && name.includes('sk c&c')) ||
                (selectedValue === 'sk-innovation' && name.includes('sk innovation')) ||
                (selectedValue === 'sk-networks' && name.includes('sk networks'))
              );
              row.style.display = shouldShow ? '' : 'none';
            }
          }
        });
      });

      // 엑셀 다운로드 버튼 기능
      const excelBtn = document.querySelector('.btn[style*="color: #10B981"]');
      if (excelBtn && excelBtn.textContent.includes('엑셀 다운로드')) {
        excelBtn.addEventListener('click', function () {
          const isMonthly = monthlyTable.style.display !== 'none';
          const period = isMonthly ? '월간' : '연간';
          const workspace = workspaceFilter.options[workspaceFilter.selectedIndex].text;
          alert(`${workspace} ${period} 사용량 통계 데이터를 엑셀로 다운로드합니다.`);
          // 실제 다운로드 로직은 여기에 구현
        });
      }

      // 무한 스크롤 기능
      let isLoading = false;
      let currentPage = 1;
      const loadingIndicator = document.getElementById('loadingIndicator');

      // 스크롤 이벤트 리스너
      window.addEventListener('scroll', function () {
        if (isLoading) return;

        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        const windowHeight = window.innerHeight;
        const documentHeight = document.documentElement.scrollHeight;

        // 페이지 하단에 도달했을 때 (100px 여유)
        if (scrollTop + windowHeight >= documentHeight - 100) {
          loadMoreData();
        }
      });

      // 더 많은 데이터 로드 함수
      function loadMoreData() {
        if (isLoading) return;

        isLoading = true;
        loadingIndicator.style.display = 'block';

        // 실제 API 호출 대신 시뮬레이션
        setTimeout(() => {
          currentPage++;

          // 더미 데이터 추가 (실제로는 API에서 데이터를 가져옴)
          const isMonthly = monthlyTable.style.display !== 'none';
          const targetTable = isMonthly ? monthlyTable : yearlyTable;
          const tbody = targetTable.querySelector('tbody');

          // 새로운 워크스페이스 데이터 추가
          const newWorkspaces = [
            { name: 'SK Biopharm', icon: 'S', color: 'color-rose' },
            { name: 'SK Materials', icon: 'S', color: 'color-violet' },
            { name: 'SK E&S', icon: 'S', color: 'color-green' }
          ];

          if (currentPage <= 3) { // 최대 3페이지까지만 로드
            const workspace = newWorkspaces[(currentPage - 2) % newWorkspaces.length];

            // 새로운 행들 추가
            for (let i = 0; i < 6; i++) {
              const row = document.createElement('tr');
              if (i === 0) {
                row.innerHTML = `
                  <td rowspan="6">
                    <div class="workspace-name">
                      <div class="workspace-icon ${workspace.color}">${workspace.icon}</div>
                      <span>${workspace.name}</span>
                    </div>
                  </td>
                  <td><strong>2024.0${i + 1}</strong></td>
                  <td>${Math.floor(Math.random() * 50) + 10}건</td>
                  <td>${Math.floor(Math.random() * 20) + 5}:${Math.floor(Math.random() * 60)}:${Math.floor(Math.random() * 60)}</td>
                  <td>${Math.floor(Math.random() * 45) + 8}건</td>
                  <td>${Math.floor(Math.random() * 18) + 4}:${Math.floor(Math.random() * 60)}:${Math.floor(Math.random() * 60)}</td>
                  <td>${Math.floor(Math.random() * 5) + 1}건</td>
                  <td>0:${Math.floor(Math.random() * 60)}:${Math.floor(Math.random() * 60)}</td>
                  <td>${Math.floor(Math.random() * 40) + 15}건</td>
                  <td>${Math.floor(Math.random() * 50000) + 20000}</td>
                  <td>${Math.floor(Math.random() * 35) + 12}건</td>
                  <td>${Math.floor(Math.random() * 3) + 1}건</td>
                `;
              } else {
                row.innerHTML = `
                  <td><strong>2024.0${i + 1}</strong></td>
                  <td>${Math.floor(Math.random() * 50) + 10}건</td>
                  <td>${Math.floor(Math.random() * 20) + 5}:${Math.floor(Math.random() * 60)}:${Math.floor(Math.random() * 60)}</td>
                  <td>${Math.floor(Math.random() * 45) + 8}건</td>
                  <td>${Math.floor(Math.random() * 18) + 4}:${Math.floor(Math.random() * 60)}:${Math.floor(Math.random() * 60)}</td>
                  <td>${Math.floor(Math.random() * 5) + 1}건</td>
                  <td>0:${Math.floor(Math.random() * 60)}:${Math.floor(Math.random() * 60)}</td>
                  <td>${Math.floor(Math.random() * 40) + 15}건</td>
                  <td>${Math.floor(Math.random() * 50000) + 20000}</td>
                  <td>${Math.floor(Math.random() * 35) + 12}건</td>
                  <td>${Math.floor(Math.random() * 3) + 1}건</td>
                `;
              }
              tbody.appendChild(row);
            }

            // 소계 행 추가
            const subtotalRow = document.createElement('tr');
            subtotalRow.style.backgroundColor = '#f8f9fa';
            subtotalRow.style.fontWeight = 'bold';
            subtotalRow.style.borderTop = '2px solid #dee2e6';
            subtotalRow.innerHTML = `
              <td colspan="2" style="text-align: center; color: #6c757d;">소계</td>
              <td>${Math.floor(Math.random() * 300) + 100}건</td>
              <td>${Math.floor(Math.random() * 100) + 50}:${Math.floor(Math.random() * 60)}:${Math.floor(Math.random() * 60)}</td>
              <td>${Math.floor(Math.random() * 280) + 90}건</td>
              <td>${Math.floor(Math.random() * 95) + 45}:${Math.floor(Math.random() * 60)}:${Math.floor(Math.random() * 60)}</td>
              <td>${Math.floor(Math.random() * 20) + 5}건</td>
              <td>${Math.floor(Math.random() * 10) + 2}:${Math.floor(Math.random() * 60)}:${Math.floor(Math.random() * 60)}</td>
              <td>${Math.floor(Math.random() * 250) + 80}건</td>
              <td>${Math.floor(Math.random() * 500000) + 200000}</td>
              <td>${Math.floor(Math.random() * 230) + 70}건</td>
              <td>${Math.floor(Math.random() * 20) + 5}건</td>
            `;
            tbody.appendChild(subtotalRow);
          }

          loadingIndicator.style.display = 'none';
          isLoading = false;
        }, 1000); // 1초 로딩 시뮬레이션
      }
    });

    // URL 파라미터로 탭 제어 기능 추가
    document.addEventListener('DOMContentLoaded', function () {
      // URL에서 period 파라미터 읽기
      const urlParams = new URLSearchParams(window.location.search);
      const periodParam = urlParams.get('period');

      if (periodParam === 'yearly') {
        // 연간 탭 활성화
        const monthlyTab = document.querySelector('.workspace-filter-row .tab.active');
        const yearlyTab = document.querySelector('.workspace-filter-row .tab.period-toggle-inactive');
        const monthlyTable = document.getElementById('monthly-table');
        const yearlyTable = document.getElementById('yearly-table');
        const monthSelect = document.getElementById('su2-m1');
        const monthSelect2 = document.getElementById('su2-m2');

        if (monthlyTab && yearlyTab && monthlyTable && yearlyTable) {
          // 탭 상태 변경
          monthlyTab.classList.remove('active', 'period-toggle-active');
          monthlyTab.classList.add('period-toggle-inactive');
          yearlyTab.classList.add('active', 'period-toggle-active');
          yearlyTab.classList.remove('period-toggle-inactive');

          // 테이블 전환
          monthlyTable.style.display = 'none';
          yearlyTable.style.display = 'block';

          // 월 선택 숨기기
          if (monthSelect) monthSelect.style.display = 'none';
          if (monthSelect2) monthSelect2.style.display = 'none';
        }
      }

      // 탭 버튼 클릭 시 URL 업데이트
      const monthlyTabBtn = document.querySelector('.workspace-filter-row .tab.active, .workspace-filter-row .tab.period-toggle-active');
      const yearlyTabBtn = document.querySelector('.workspace-filter-row .tab.period-toggle-inactive');

      if (monthlyTabBtn) {
        monthlyTabBtn.addEventListener('click', function () {
          const newUrl = new URL(window.location);
          newUrl.searchParams.set('period', 'monthly');
          window.history.pushState({}, '', newUrl);
        });
      }

      if (yearlyTabBtn) {
        yearlyTabBtn.addEventListener('click', function () {
          const newUrl = new URL(window.location);
          newUrl.searchParams.set('period', 'yearly');
          window.history.pushState({}, '', newUrl);
        });
      }
    });
  </script>
  <script src="../asset/menu.js"></script>
  <script src="../asset/main.js"></script>
</body>

</html>